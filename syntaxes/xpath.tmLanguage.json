{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "XPath",
    "patterns": [
        {
            "include": "#tokens"
        },
        {
            "include": "#xquery"
        },
        {
            "include": "#comments"
        }
    ],
    "repository": {
        "tokens": {
            "name": "xpath.token",
            "match": "(?<token>(?<t>\\|(?:\\*|\\%)\\|).+?\\g<t>)(?<d>\\-\\>|\\s=\\s)(?<v>.+?)$",
            "captures": {
                "1": {
                    "name": "constant.regexp"
                },
                "3": {
                    "name": "punctuation.definition.tag"
                },
                "4": {
                    "patterns": [
                        {
                            "name": "keyword",
                            "match": "\\b(true|false|null|Transport|None|YES|NO||OFF|ON|yes|no)\\b"
                        },
                        {
                            "name": "markup.inline.raw",
                            "match": "\\d+"
                        },
                        {
                            "name": "constant.regexp",
                            "match":"(?<type>\\|(?:\\*|\\%)\\|)(.+?)\\g<type>"
                        }
                    ]
                }
            }
        },
        "xquery": {
            "name": "xpath.xquery",
            "match": "^(\\/\\/.+?)(\\-\\>)(.*)$",
            "captures": {
                "1": {
                    "patterns": [
                        {
                            "name": "markup.inline.raw",
                            "match": "(\\*?\\[)(@?.+?)(=)((?<q>\\\"|\\'))(.+?)(\\g<q>)(\\])",
                            "captures": {
                                "1": {
                                    "name": "string.regexp"
                                },
                                "2": {
                                    "name": "keyword.control"
                                },
                                "3": {
                                    "name": "punctuation.definition.tag"
                                },
                                "4": {
                                    "name": "string"
                                },
                                "5": {
                                    "name": "string.regexp"
                                },
                                "6": {
                                    "name": "markup.italic"
                                },
                                "7": {
                                    "name": "string"
                                },
                                "8": {
                                    "name": "string.regexp"
                                }
                            }
                        },
                        {
                            "name": "constant.character",
                            "match": "\\[\\d+\\]"
                        },
                        {
                            "name": "constant.character.escape",
                            "match": "(\\-\\>)"
                        },
                        {
                            "name": "punctuation.definition.tag",
                            "match": "\\/"
                        },
                        {
                            "name": "keyword.control",
                            "begin": "@",
                            "end": "(?=->)"
                        },
                        {
                            "name": "variable.name",
                            "match": "\\/(.+?)"
                        },
                        {
                            "name": "constant.regexp",
                            "match":"(?<type>\\|(?:\\*|\\%)\\|)(.+?)\\g<type>"
                        }
                    ]
                },
                "2": {
                    "name": "punctuation.definition.tag"
                },
                "3": {
                    "patterns": [
                        {
                            "name": "keyword",
                            "match": "\\b(true|false|[Nn]ull|Transport|[Nn]one|[Yy][Ee][Ss]|[Nn][Oo]||[Oo][Ff]{2}|[Oo][Nn])\\b"
                        },
                        {
                            "name": "constant.regexp",
                            "match":"(\\|(?<t>\\*|\\%)\\|).+?\\|\\g<t>\\|"
                        },
                        {
                            "name": "markup.heading",
                            "match": "(\\w{3,5}\\:\\/\\/)[\\-\\w\\_\\.]+"
                        }
                    ]
                }
            }
        },
        "comments": {
            "name": "comment",
            "match":"^\\s*(#).+?$"
        }
    },
    "scopeName": "source.xpath"
}